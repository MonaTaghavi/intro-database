SELECT * FROM crime_scene_report
WHERE city = 'SQL City' and date = 20180115 and type = 'murder';

Security footage shows that there were 2 witnesses. The first witness lives at the last house on "Northwestern Dr". The second witness, named Annabel, lives somewhere on "Franklin Ave".

SELECT * FROM person
INNER JOIN interview
ON person.id = interview.person_id
WHERE address_street_name = 'Northwestern Dr'
ORDER BY address_number DESC
LIMIT 1;

person_id: 14887
Morty Schapiro

I heard a gunshot and then saw a man run out. He had a "Get Fit Now Gym" bag. The membership number on the bag started with "48Z". Only gold members have those bags. The man got into a car with a plate that included "H42W".


SELECT * FROM person
INNER JOIN interview
ON person.id = interview.person_id
WHERE name LIKE '%Annabel%' AND address_street_name = 'Franklin Ave';

person_id: 16371
Annabel Miller

I saw the murder happen, and I recognized the killer from my gym when I was working out last week on January the 9th.

*********************

select * from get_fit_now_member gfnm
INNER JOIN person p
ON p.id = gfnm.person_id
INNER JOIN drivers_license dl
ON dl.id = p.license_id
INNER JOIN get_fit_now_check_in gfnci
ON gfnci.membership_id = gfnm.id
where gfnm.id like '48Z%' and membership_status = 'gold' AND check_in_date = 20180109


Here is murdere:
person_id: 67318
Jeremy Bowers

SELECT * FROM person
INNER JOIN interview
ON person.id = interview.person_id
WHERE person_id = 67318;

I was hired by a woman with a lot of money. I don't know her name but I know she's around 5'5" (65") or 5'7" (67"). She has red hair and she drives a Tesla Model S. I know that she attended the SQL Symphony Concert 3 times in December 2017.

select * from person p
INNER JOIN drivers_license dl
ON p.license_id = dl.id
WHERE gender = 'female' AND height BETWEEN 65 AND 67
AND hair_color = 'red' AND car_make = 'Tesla'
AND car_model = 'Model S'


select person_id from facebook_event_checkin fec
WHERE event_name = 'SQL Symphony Concert'
AND date BETWEEN 20171201 AND 20171231
GROUP BY person_id
HAVING count(*) = 3

24556
Bryan Pardo

99716
Miranda Priestly


SELECT * FROM person
	INNER JOIN drivers_license dl
	ON dl.id = person.license_id
	WHERE person.id IN (
		SELECT person_id FROM person
		INNER JOIN facebook_event_checkin fec
		ON person.id = fec.person_id
		WHERE event_name = 'SQL Symphony Concert'
		AND date BETWEEN 20171201 AND 20171231
		GROUP BY person_id
		HAVING count(*) = 3);

99716
Miranda Priestly